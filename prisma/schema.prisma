// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model MuscleGroup {
  id       Int        @id @default(autoincrement())
  label    String
  Exercise Exercise[]
}

model Routine {
  id           Int    @id @default(autoincrement())
  label        String
  dayOfTheWeek String
  order        Int?
  userId       Int

  user User @relation(fields: [userId], references: [id])

  RoutineWorkout RoutineWorkout[]
}

model RoutineWorkout {
  id        Int @id @default(autoincrement())
  routineId Int
  workoutId Int

  routine Routine @relation(fields: [routineId], references: [id])
  workout Workout @relation(fields: [workoutId], references: [id])
}

model Workout {
  id    Int    @id @default(autoincrement())
  label String

  WorkoutExercise WorkoutExercise[]
  RoutineWorkout  RoutineWorkout[]

  @@map("workout")
}

model WorkoutExercise {
  id    Int    @id @default(autoincrement())
  label String

  exerciseId Int
  workoutId  Int
  userId     Int
  order      Int // WHAT IS THE SEQUENCE TO FOLLOW
  rest       Int @default(90)
  volume     Int
  series     Int
  weight     Int

  user     User     @relation(fields: [userId], references: [id])
  workout  Workout  @relation(fields: [workoutId], references: [id])
  Exercise Exercise @relation(fields: [exerciseId], references: [id])

  @@map("workout-exercise-execution")
}

model Exercise {
  id            Int           @id @default(autoincrement())
  name          String
  rest          Int?
  sugVolume     String        @map("sug-volume")
  sugSeries     Int           @default(3) @map("sug-series")
  executionUnit ExecutionUnit
  muscleGroupId Int

  muscleGroup MuscleGroup @relation(fields: [muscleGroupId], references: [id])

  WorkoutExercise WorkoutExercise[]

  @@map("exercise")
}

enum ExecutionUnit {
  TIME
  REPETITION
}

model User {
  id              Int               @id @default(autoincrement())
  name            String
  email           String
  dateOfBirth     DateTime
  height          Int
  imageUrl        String?
  WorkoutExercise WorkoutExercise[]
  Routine         Routine[]

  @@map("user")
}
